namespace = magiks_event

### Magiks Event ###

planet_event = {
	id = magiks_event.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_modifier = "magiks_dragons_tamed"
		owner = {
			NOT = {
				has_civic = "magiks_civic_dragon_tamers"
			}
		}
	}
	
	immediate = {
		remove_modifier = "magiks_dragons_tamed"
	}
}
planet_event = {
	id = magiks_event.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		magiks_generate_start_pops = yes
	}
}

### Hyperlane events ###

#-- Creates within own border
system_event = {
	id = magiks_event.4
	desc = magiks_decision_hyperlane_found_desc
	is_triggered_only = yes
	option = {
		name = "Let's start"
		custom_tooltip = "Requires 1000 energy, 1 influence and 50 manacite"
		allow = {
			space_owner = {
				has_resource = {
					type = energy
					amount >= 1000
				}
				has_resource = {
					type = manacite
					amount >= 50
				}
				has_resource = {
					type = influence
					amount >= 1
				}
			}
		}
		hidden_effect = {
			log = "Core Planet: [From.GetName] Other System: [This.GetName]"
			add_hyperlane = {
				from = From.solar_system
				to = This
			}
			space_owner = {
				add_resource = {
					energy = -1000
					manacite = -50
					influence = -1
				}
			}
		} 
	}
	option = {
		name = "Nevermind"
	}
}

#-- Creation (Not Found Event)
system_event = {
	id = magiks_event.5
	desc = "No valid neighbour was found for [This.GetName]"
	is_triggered_only = yes
	option = {
		name = "Unfortunate"
	}
}

#-- Deletes within own border
system_event = {
	id = magiks_event.6
	desc = "Found a hyperlane from [From.GetName] to [This.GetName]!"
	is_triggered_only = yes
	option = {
		name = "Commence removal"
		custom_tooltip = "Requires 1000 energy, 1 influence and 50 manacite"
		allow = {
			space_owner = {
				has_resource = {
					type = energy
					amount >= 1000
				}
				has_resource = {
					type = manacite
					amount >= 50
				}
				has_resource = {
					type = influence
					amount >= 1
				}
			}
		}
		hidden_effect = {
			log = "Core Planet: [From.GetName] Other System: [This.GetName]"
			remove_hyperlane = {
				from = From.solar_system
				to = This
			}
			space_owner = {
				add_resource = {
					energy = -1000
					manacite = -50
					influence = -1
				}
			}
		} 
	}
	option = {
		name = "Nevermind"
	}
}

#-- Deletion (Not Found Event)
system_event = {
	id = magiks_event.7
	desc = "No valid neighbour was found for [This.GetName]"
	is_triggered_only = yes
	option = {
		name = "Alone in the void"
	}
}

#-- Creates out of border
system_event = {
	id = magiks_event.8
	desc = magiks_decision_hyperlane_found_desc
	is_triggered_only = yes
	option = {
		name = "Let's start"
		custom_tooltip = "Requires 2500 energy, 4 influence and 150 manacite"
		allow = {
			space_owner = {
				has_resource = {
					type = energy
					amount >= 2500
				}
				has_resource = {
					type = manacite
					amount >= 150
				}
				has_resource = {
					type = influence
					amount >= 4
				}
			}
		}
		hidden_effect = {
			add_hyperlane = {
				from = From.solar_system
				to = This
			}
			space_owner = {
				add_resource = {
					energy = -1000
					manacite = -50
					influence = -1
				}
			}
			From = {
				if = {
					limit = { exists = space_owner }
					space_owner = {
						#log = "Space Owner: [This.GetName] PrevPrev: [PrevPrev.GetName] PrevPrevspace_owner: [PrevPrev.space_owner.GetName]"
						add_opinion_modifier = {
							who = PrevPrev.space_owner
							modifier = triggered_opinion_disapprove_of_hyperlane_manipulation
						}
					}
				}
			}
		} 
	}
	option = {
		name = "Nevermind"
	}
}

#-- Deletes out of border
system_event = {
	id = magiks_event.9
	desc = magiks_decision_hyperlane_found_desc
	is_triggered_only = yes
	option = {
		name = "Let's start"
		custom_tooltip = "Requires 2500 energy, 4 influence and 150 manacite"
		allow = {
			space_owner = {
				has_resource = {
					type = energy
					amount >= 2500
				}
				has_resource = {
					type = manacite
					amount >= 150
				}
				has_resource = {
					type = influence
					amount >= 4
				}
			}
		}
		hidden_effect = {
			remove_hyperlane = {
				from = From.solar_system
				to = This
			}
			space_owner = {
				add_resource = {
					energy = -1000
					manacite = -50
					influence = -1
				}
			}
			From = {
				if = {
					limit = { exists = space_owner }
					space_owner = {
						#log = "Space Owner: [This.GetName] PrevPrev: [PrevPrev.GetName] PrevPrevspace_owner: [PrevPrev.space_owner.GetName]"
						add_opinion_modifier = {
							who = PrevPrev.space_owner
							modifier = triggered_opinion_disapprove_of_hyperlane_manipulation
						}
					}
				}
			}
		} 
	}
	option = {
		name = "Nevermind"
	}
}